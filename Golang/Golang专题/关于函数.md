# 关于函数

函数是引用类型。传入函数做的是浅表复制，传的都是值的副本。如果参数是引用类型，则拷贝了指向底层数组元素的指针，因此如果传入值为切片，函数内修改会影响切片本身。

## 什么是一等公民？

函数作为一等(`first class`)公民，是函数式编程(`functional programming`)的重要特征。函数可以用于封装代码、分割功能、解耦逻辑、作为普通人在其他函数间传递、赋予变量、做类型判断或转换等。

## 高阶函数和闭包

高阶函数指函数将其他函数作为参数传入，或将其他函数作为结果返回。

```go
package main

import "errors"

type operate func(x, y int) int
type inner func(x, y int) (int, error)

func demo(x, y int, fn operate) (int, error) {
	// 卫述语句用于检查关键的先决条件合法性，并在非法状态下立即终止代码块执行
	if fn == nil {
		return 0, errors.New("Invalid Opetation")
	}
	return fn(x, y), nil
}

// 闭包函数(closure)
// 引用了自由变量呈现开放状态
func example(fn operate) inner {
	return func(x, y int) (int, error) {
		// 编译器会寻找绑定fn，捕获自由变量，开放状态变为确定
		if fn == nil {
			return 0, errors.New("Invalid Operation")
		}
		return fn(x, y), nil
	}
}

func main() {
	fn := func(x, y int) int {
		return x + y
	}
    demo(1, 2, fn)
    example(fn)(1, 2)
}
```
