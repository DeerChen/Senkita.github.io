# 持续集成

## 链接

1. [Github Actions 官方市场](https://github.com/marketplace?type=actions)
2. [awesome-actions](https://github.com/sdras/awesome-actions)

## 配置

`.github/workflows/build.yaml`

```yaml
# 工作流程名
name: build

# 触发条件
on:
    push:
        # 限定分支
        branches:
            - main

# 任务
jobs:
    # job_id
    job1:
        # 镜像平台
        runs-on: ubuntu-latest
        # 步骤
        steps:
            # 步骤描述
            - name: checkout main
              # 使用已有包
              uses: actions/checkout@v2
              # 改动分支
              with:
                  ref: main

    job2:
        # 执行顺序
        needs: job_1
        steps:
            - name: push remote
              # 步骤环境变量
              env:
                  # 在Settings-Develop settings-Personal access tokens中设置
                  TOKEN: ${{ secrets.TOKEN }}
                  REF: github.com/${{github.repository}}
                  EMAIL: demo@example.com
                  NAME: ${{github.repository_owner}}
              #   执行步骤
              run: |
                  git config --global user.email "${EMAIL}"
                  git config --global user.name "${NAME}"
                  git init
                  git remote add origin https://${REF}
                  git branch -M main
                  git push --force --quiet "https://${TOKEN}@${REF}" main:main
```
